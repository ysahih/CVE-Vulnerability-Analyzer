import pandas as pd
import requests
import random

def fetch_vulnerabilities():
    response = requests.get("https://services.nvd.nist.gov/rest/json/cves/2.0")
    data = response.json()
    return data['vulnerabilities']


def print_descriptions(data):
    descriptions = data['cve.descriptions']
    
    for list in descriptions:
        for line in list:
            print(f"- {line.get('value')}")


def parse_data(data):
    #convert the published date to a readable date format
    data['cve.published'] = pd.to_datetime(data['cve.published'])

    #adding new column that contains the year of published
    data['year'] = data['cve.published'].dt.year

    #search for the last 2000's vulnerabilities
    data = data[data['year'] == 2000]
    
    # print out random five vulnerabilities descriptions
    start = random.randint(0, 9)
    end = start + 5
    print_descriptions(data[start:end])


vulnerabilities = fetch_vulnerabilities()

#create a DataFrame from the fetched data
df = pd.json_normalize(vulnerabilities)

parse_data(df)

